<!DOCTYPE html>
<html>
  <head>
    <title>webpackã®ä½¿ã„æ–¹ã‹ã‚‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¾ã§ï¼ˆå…¨2å›ï¼‰å‰ç·¨</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style type="text/css">
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body {
        font-family: 'Droid Serif', 'YuGothic', 'Arial', serif;
      }
      h1, h2, h3, h4 {
        font-weight: normal;
        color: #c18100;
        line-height: 1.2;
      }
      a,
      a:link,
      a:visited {
        color: #825700;
      }
      li {
        margin-top: 5px;
      }
      li:first-child {
        margin-top: 0;
      }
      ul ul {
        margin-top: 5px;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
      .big {
        font-size: 150px;
      }
      code.text {
        white-space: normal;
      }
      pre {
        padding: 1em;
        background-color: #eee;
      }
      table {
        width: 100%;
      }
      th {
        padding: 0.5em;
        background-color: #ffdbb6;
      }
      td {
        padding: 0.5em;
        background-color: #fff7e7;
      }
      tr {
        background-color: #eee;
      }
      blockquote {
        display: inline-block;
        padding: 0 1em;
        margin-left: 0;
        background: #eee;
        border-left: 5px solid #4c3300;
      }
      .w100 img {
        width: 100%;
      }
      .del {
        text-decoration: line-through;
      }
      .remark-slide-scaler {
        overflow: scroll;
      }
      .remark-slide-number {

      }
    </style>
  </head>
  <body>
    <textarea id="source">


      class: center, middle

      # webpackã®ä½¿ã„æ–¹
      ## ï¼ˆå¾Œç·¨ï¼‰

      2018/01/30

      Kobayashi Kazuhiro (kzhrk)

      ---

      ## æœ¬æ—¥ã®ãƒ†ãƒ¼ãƒ

      - èª²é¡Œãƒã‚§ãƒƒã‚¯
      - å‰å›ã®ãŠã•ã‚‰ã„
      - ã‚ˆãã‚ã‚‹webpack.config.js
      - webpackã§jQueryã‚’ä½¿ã†
      - èª²é¡Œ

      ---
      class: center, middle

      # èª²é¡Œãƒã‚§ãƒƒã‚¯

      ---

      ## å‰å›ã®èª²é¡Œ

      src/js/modulesé…ä¸‹ã«ä½•ã‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¦console.logã§è¡¨ç¤ºã™ã‚‹

      ä¾‹ï¼šsub.jsï¼ˆå¼•ãç®—ï¼‰ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¦å¼•ãç®—ã®çµæœã‚’è¡¨ç¤ºã™ã‚‹

      ---
      class: center, middle

      # å‰å›ã®ãŠã•ã‚‰ã„

      ---

      ## webpackã¨webpack-stream

      - webpackã¯é™çš„ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã€‚
      - gulpã§ä½¿ã‚ã‚Œã¦ã„ã‚‹webpack-streamã®ä¸­èº«ã¯webpackã€‚
      - webpackï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ï¼‰ãŒãªã„ã¨å®‰å…¨ãªJavaScripté–‹ç™ºã¯ä¸å¯èƒ½ã€‚

      ---
      class: center, middle

      # å‰å›ã®å‹˜é•ã„

      ---

      ## webpack-cli

      - webpack.config.jsã‚’v1ã‹ã‚‰v2ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
      - webpackã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ–°è¦ä½œæˆ
      - **CLIã§ã®webpackã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¤ã®ã¨ã¯ä¸€åˆ‡é–¢ä¿‚ãªã„**

      ---
      class: center, middle

      # ğŸ™‡ğŸ™‡ğŸ™‡

      ---

      ## å‰å›ã®ç™ºè¡¨ä¸­ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

      - ã‚ˆãã‚ã‚‹webpack.config.jsã®è¨˜è¿°
      - webpackã§jQueryã‚’ä½¿ç”¨ã™ã‚‹ã¨ãã®è¨­å®šæ–¹æ³•
      - <del>ES Moduleï¼ˆimport|exportï¼‰ã®æ¦‚å¿µ</del>

      ---
      class: center, middle

      # ã‚ˆãã‚ã‚‹webpack.config.js

      ---

      ## entry

      ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã€‚ãƒãƒ³ãƒ‰ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‡ºåŠ›ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®å®šç¾©ã‚’è¡Œã†ã€‚

      ```:js
      [...]
        entry: {
          app: './src/app.js',
          vendors: ['jquery', 'velocity-animate']
        }
      [...]
      ```

      https://webpack.js.org/concepts/entry-points/

      ---

      ## output

      ãƒãƒ³ãƒ‰ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡ºåŠ›å…ˆã€‚

      pathã«ã¯çµ¶å¯¾ãƒ‘ã‚¹ã‚’æŒ‡å®šã€‚

      ```:js
      [...]
        output: {
          path: path.resolve(__dirname, './public/js'),
          filename: '[name].js'
        }
      [...]
      ```

      https://webpack.js.org/concepts/output/

      ---

      ## resolve

      ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å‘¼ã³å‡ºã—è§£æ±ºã®è¨­å®šã€‚

      ```:js
      [...]
        resolve: {
          alias: {
            jquery: "jquery/src/jquery"
          },
          extensions: ['.js', '.scss', '.pug']
        }
      [...]
      ```

      https://webpack.js.org/configuration/resolve/

      ---

      ## module

      è¨˜è¿°ã®ç•°ãªã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‘¼ã³å‡ºã—æ–¹æ³•ã®è¨­å®šã€‚

      JavaScriptï¼ˆES Moduleï¼‰ã§ã¯ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’import|requireã—ãŸéš›ã®å‡¦ç†æ–¹æ³•ã€‚

      loaderã¨å‘¼ã°ã‚Œã‚‹npmã§å‘¼ã³å…ˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’JavaScriptã§ä½¿ãˆã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¤‰æ›ã™ã‚‹ã€‚

      ```:js
      [...]
        module: {
          rules: [
            {
              test: /\.js$/,
              use: [{
                loader: "babel-loader"
              }]
            }
          ]
        }
      [...]
      ```

      ---

      ## plugins

      ãƒãƒ³ãƒ‰ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›ã€‚

      ```:js
      [...]
        plugins: [
          new webpack.optimize.UglifyJsPlugin()
        ]
      [...]
      ```

      ---
      class: center, middle

      # webpackã§jQueryã‚’ä½¿ã†

      ---

      ## webpackã§jQueryã‚’ä½¿ã†æ–¹æ³•

      - entry point or moduleã§npmã®jqueryã‚’import
      - resolve.alias.jqueryã§npmã‚’è¨­å®š
      - ProvidePlugin
      - CommonsChunkPlugin

      https://kzhrk-sandbox.github.io/training-webpack/step2/public/

      ---

      ## å„ãƒ•ã‚¡ã‚¤ãƒ«ã§import

      - å„ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§jQueryã®å‘¼ã³å‡ºã—ã®è¨˜è¿°ãŒå¿…è¦
      - ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ï¼ˆwindow.$ï¼‰ã«jQueryãŒéœ²å‡ºã—ãªã„
        - webpackã®ãƒãƒ³ãƒ‰ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ä»¥å¤–ã§èª­ã¿è¾¼ã¾ã‚ŒãŸjQueryã¨ã®ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã‚’é˜²ã’ã‚‹

      ---

      ## resolve.aliasã‚’è¨­å®š

      - ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«npmã®jQueryãŒå®šç¾©ã•ã‚Œã‚‹
        - webpackã®ãƒãƒ³ãƒ‰ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ä»¥å¤–ã§èª­ã¿è¾¼ã¾ã‚ŒãŸjQueryã¨ã®ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã™ã‚‹

      ---

      ## ProvidePluginã‚’è¨­å®š

      - å„ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§jQueryã®å‘¼ã³å‡ºã—ãŒä¸è¦
      - ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ï¼ˆwindow.$ï¼‰ã«jQueryãŒéœ²å‡ºã—ãªã„
        - webpackã®ãƒãƒ³ãƒ‰ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ä»¥å¤–ã§èª­ã¿è¾¼ã¾ã‚ŒãŸjQueryã¨ã®ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã‚’é˜²ã’ã‚‹

      ---

      ## CommonsChunkPluginã‚’è¨­å®š

      - å…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç”¨ã®entryãƒã‚¤ãƒ³ãƒˆãŒå¿…è¦
      - å„ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§jQueryã®å‘¼ã³å‡ºã—ã®è¨˜è¿°ãŒå¿…è¦
      - ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ï¼ˆwindow.$ï¼‰ã«jQueryãŒéœ²å‡ºã—ãªã„
        - webpackã®ãƒãƒ³ãƒ‰ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ä»¥å¤–ã§èª­ã¿è¾¼ã¾ã‚ŒãŸjQueryã¨ã®ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã‚’é˜²ã’ã‚‹
      - å…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç”¨ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆvendor.bundle.jsï¼‰ãŒå‡ºåŠ›ã•ã‚Œã‚‹ã®ã§buildãŒè»½ã„

      ---
      class: center, middle

      # CommonChunkPluginã‚’<br>ä½¿ãŠã†

      ---
      class: center, middle

      # è¤‡æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®jQuery

      ---

      ## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ

      ```
      packages
      â”œâ”€â”€ jquery2
      â”‚   â”œâ”€â”€ index.js
      â”‚   â””â”€â”€ package.json
      â””â”€â”€ jquery3
          â”œâ”€â”€ index.js
          â””â”€â”€ package.json
      ```

      ãã‚Œãã‚Œjquery@2, jquery@3ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

      package.jsonã®mainã«ã¯index.jsã‚’æŒ‡å®šã€‚

      ---

      ## index.js

      ãã‚Œãã‚Œnpm installã—ãŸjqueryã‚’exportã™ã‚‹ã ã‘

      ```:js
      module.exports = require('jquery');
      ```

      ---

      ## ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

      ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã§ãƒ­ãƒ¼ã‚«ãƒ«ã®jqueryã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

      ```
      $ npm i -D packages/jquery2 packages/jquery3
      ```

      package.json

      ```:js
      [...]
      "devDependencies": {
        "jquery2": "file:packages/jquery2",
        "jquery3": "file:packages/jquery3"
      }
      [...]
      ```

      ---

      ## ãã‚Œãã‚Œã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ã†

      ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å‡ºåŠ›

      ```:js
      import $2 from 'jquery2';
      import $3 from 'jquery3';
      [...]
      $('#js-jq2').append($2.fn.jquery);
      $('#js-jq3').append($3.fn.jquery);
      [...]
      ```

      jquery@3ã‹ã‚‰å®Ÿè£…ã•ã‚ŒãŸ[jQuery.escapeSelector()](https://api.jquery.com/jQuery.escapeSelector/)ã‚’å®Ÿè¡Œ

      ```:js
      [...]
      console.log('$3: ' + $3.escapeSelector('.test'));
      console.log('$2: ' + $2.escapeSelector('.test'));
      [...]
      ```

      ---
      class: center, middle

      # ã‚ˆãã¤ã‹ã†npm

      ---

      ## npm

      - [js-cookie](https://www.npmjs.com/package/js-cookie)
      - [slick-carousel](https://www.npmjs.com/package/slick-carousel)
      - [velocity-animate](https://www.npmjs.com/package/velocity-animate)
      - [animejs](https://www.npmjs.com/package/animejs)

      ---
      class: center, middle

      # END


    </textarea>
    <script src="js/remark.min.js" type="text/javascript">
    </script>
    <script type="text/javascript">
      var slideshow = remark.create({
        navigation: {
          scroll: false
        }
      });
    </script>
  </body>
</html>
